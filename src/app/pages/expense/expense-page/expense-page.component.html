<div class="expense-page-container">
  <div class="expense-form-container">
    <form class="form-container" [formGroup]="form" (ngSubmit)="submitExpense(currentForm)" #currentForm="ngForm">
      <mat-form-field appearance="outline">
        <mat-label>Expense title</mat-label>
        <input matInput required formControlName="name">
        <mat-error *ngIf="form.controls['name'].hasError('required')">Field is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Description</mat-label>
        <textarea matInput
                  cdkTextareaAutosize
                  cdkAutosizeMinRows="1"
                  cdkAutosizeMaxRows="5"
                  required
                  formControlName="description">

        </textarea>
        <mat-error *ngIf="form.controls['description'].hasError('required')">Field is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Select expense type</mat-label>
        <mat-select required formControlName="expenseType">
          <mat-option [value]="expenseTypes.PublicTransport">Public Transport</mat-option>
          <mat-option [value]="expenseTypes.Mileage">Mileage</mat-option>
          <mat-option [value]="expenseTypes.Food">Food</mat-option>
          <mat-option [value]="expenseTypes.Accommodation">Accommodation</mat-option>
          <mat-option [value]="expenseTypes.Other">Other</mat-option>
        </mat-select>
        <mat-error *ngIf="form.controls['expenseType'].hasError('required')">Field is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Select date</mat-label>
        <input matInput [matDatepicker]="picker" required formControlName="expenseDate" [max]="todaysDate">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker ></mat-datepicker>
        <mat-error *ngIf="form.controls['expenseType'].hasError('required')">Field is required</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>How much was spent?</mat-label>
        <input matInput type="number" formControlName="value" required>
        <span matPrefix>Â£&nbsp;&nbsp;&nbsp;</span>
        <mat-error *ngIf="form.controls['expenseType'].hasError('required')">Field is required</mat-error>
      </mat-form-field>
      <button mat-raised-button type="submit" [disabled]="!currentForm.valid">Submit expense</button>
    </form>
  </div>
  <div>
    <h2 class="expense-header">You currently have {{allExpensesCount$ | async}} expenses!</h2>
  </div>
  <div class="card-container">
    <div *ngFor="let expense of allExpenses$ | async" @aatext>
      <expense-card (deleteClicked)="deleteExpense(expense.id)" [expenseItem]="expense" @aatext></expense-card>
    </div>
  </div>
</div>

